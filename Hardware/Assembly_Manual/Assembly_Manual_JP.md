[Electrical_Circuit_Diagram]:https://github.com/takuyani/SLAM-Robot_Docs/blob/master/Hardware/Electrical_Circuit_Diagram/Electrical_Circuit_Diagram.pdf

# **～SLAMロボット車体制作マニュアル～**  (Rev.1.0)
<br>
![vehicle](https://farm9.staticflickr.com/8136/29983598960_4a01cd1490_b.jpg)

#### ◆参考資料
作成する際に、以下の資料を参考にしてください。
- [Electrical_Circuit_Diagram.pdf][Electrical_Circuit_Diagram]

***
# 1. SLAMロボット車体作成
SLAMロボット車体は大きく分けて以下に列挙するユニットから構成されています。
これらを組み合わせることでSLAMロボット車体が完成します。

1. [**回路ユニット**](#11-回路ユニット)
2. [**MCUユニット**](#12-mcuユニット)
3. [**車体本体**](#13-車体本体)  

以下、SLAMロボットの全体概要です。
![fig.1](https://farm6.staticflickr.com/5790/30362394065_808101cff4_b.jpg)

まずは、各ユニットの作成手順について説明します。
***
## 1.1. 回路ユニット
回路ユニットの作成手順について説明します。  
以下のファイルが本SLAMロボットを構成する回路の全体図です。
- [Electrical_Circuit_Diagram.pdf][Electrical_Circuit_Diagram]  

ここで、回路ユニットを構成する領域は下図1.1.1の赤枠で囲まれている範囲です。

|図1.1.1|
|:--:|
|![fig.1.1.1](https://farm9.staticflickr.com/8419/30306549026_0d9d04e572_b.jpg)|
ちなみに、モーターを示すM1,M2ですが、
- M1 → 右車輪用
- M2 → 左車輪用

となっています。
また、回路ユニットは以下２つの回路によって構成されています。
- 電源回路
- DCコンバータ回路

完成図を下図1.2に載せます。

|図1.1.2|
|:--:|
|![fig.1.1.2](https://farm6.staticflickr.com/5624/29607025143_49159b790a_b.jpg)|

以下、各回路の仕様について簡単に説明します。

### 1.1.1. 電源回路
電源回路を構成するのは下図1.1.3の赤枠の領域です。

|図1.1.3|
|:--:|
|![fig.1.1.3](https://farm9.staticflickr.com/8139/29711616514_a1d96c92a7_b.jpg)|

入力電圧は12Vを、入力最大電流は5Aを想定しています。  
図中のSW1はメインスイッチです。SLAMロボット全体の電源を一括してON/OFFします。  
図中のSW2はモーター電源スイッチです。モーター部への電源供給をON/OFFします。
また、モーター部へは入力電圧がそのまま供給されます。  
完成図を下図1.1.4に載せます。また、SW1,SW2をONにした状態の図を下図1.1.5に載せます。

|図1.1.4|図1.1.5|
|:--|:--|
|![fig.1.1.4](https://farm6.staticflickr.com/5701/29724979813_0ae7d8d54f_b.jpg)|![fig.1.1.5](https://farm6.staticflickr.com/5547/29606263534_0f1844382c_b.jpg)|
|・SW1をONするとOUT①が出力されます。<br>・SW1がONの状態で、SW2をONするとOUT②が出力されます。|・SW1がON　→　赤色LEDが点灯<br>・SW2がON　→　緑色LEDが点灯|


### 1.1.2. DCコンバータ回路
電源供給回路を構成するのは下図1.1.6の赤枠の領域です。

|図1.1.6|
|:--:|
|![fig.1.1.6](https://farm6.staticflickr.com/5583/30044910490_67ff1f4ee1_b.jpg)|

本回路では入力電圧12Vを5Vに降圧しています。  
また、最大出力電流は3Aとなっています。  
なお、回路を構成する電子部品については、[Electrical_Circuit_Diagram.pdf][Electrical_Circuit_Diagram]ファイル中に記載されているため、本項では省略します。  
完成図を下図1.1.7に載せます。

|図1.1.7|
|:--:|
|![fig.1.1.7](https://farm6.staticflickr.com/5516/29724980063_e8bd67b63a_b.jpg)|

***
## 1.2. MCUユニット
MCUユニットの作成手順について説明します。  
MCUユニットを構成する領域は下図1.2.1の赤枠で囲まれている範囲です。

|図1.2.1|
|:--:|
|![fig.1.2.1](https://farm6.staticflickr.com/5715/30255657431_4c6bd141bd_b.jpg)|

以下、MCUユニットを構成するパーツリストと作成手順について説明します。
### 1.2.1. パーツリスト  
|No.|パーツ名|型番|数量|備考|
|:--|:--|:--|:--|:--|
|1|BeagleBone Black(Element14)|-|1|[購入先リンク](http://akizukidenshi.com/catalog/g/gM-06867/)|
|2|BeagleBoneユニバーサルプロトケープ|-|1|[購入先リンク](http://akizukidenshi.com/catalog/g/gP-07190/)|

### 1.2.2. 作成手順
作成に関しては基本的に図1.2.1中の回路を組めばよいため作成手順に関しては省略します。  
また回路を実装する際に、「BeagleBoneユニバーサルプロトケープ」を使うと、BeagleBone Black本体と合体でき、省スペース化ができるため、お勧めです。

|図1.2.2|図1.2.3|図1.2.4|
|:--:|:--:|:--:|
|![fig.1.2.2](https://farm6.staticflickr.com/5630/30327709356_6a087c9059_b.jpg)|![fig.1.2.3](https://farm6.staticflickr.com/5761/29731243733_8a54368916_b.jpg)|![fig.1.2.4](https://farm9.staticflickr.com/8416/30263228855_12671a44c5_b.jpg)|
|BeagleBone Black本体|ユニバーサルプロトケープ|BeagleBone Black本体 + ユニバーサルプロトケープ|

***
## 1.3. 車体本体
車体本体のパーツリストと作成手順について説明します。
### 1.3.1. パーツリスト
|No.|パーツ名|型番|数量|備考|
|:--|:--|:--|:--|:--|
|1|ステッピングモーター| SM-42BYG011-25|2|[購入先リンク](https://strawberry-linux.com/catalog/items?code=12026)|
|2|L6470 ステッピングモータ・ドライバキット|-|2|[購入先リンク](https://strawberry-linux.com/catalog/items?code=12023)|
|3|L6470/42x34mmステッピングモーター用ネジセット|-|2|[購入先リンク](https://strawberry-linux.com/catalog/items?code=12051)|
|4|10Pフラットケーブル(30cm)|-|2|[購入先リンク](https://strawberry-linux.com/catalog/items?code=90009)|
|5|アルミホイールΦ44（1個入）|-|2|[購入先リンク](http://www.rt-shop.jp/index.php?main_page=product_info&cPath=1348_1&products_id=698)|
|6|タイヤΦ44用7.5mm幅（2個入）|-|1|[購入先リンク](http://www.rt-shop.jp/index.php?main_page=product_info&cPath=1348_1&products_id=699)|
|7|L字固定具（ステッピングモーター用）|-|2|[購入先リンク](https://ja.aliexpress.com/item/Free-shipping-1pcs-NEMA-17-Mounting-L-Bracket-Mount-42-series-Stepper-Motor/32342209019.html)|
|8|ユニバーサルプレートL(210×160mm)|-|2|[購入先リンク](http://www.tamiya.com/japan/products/70172plate/index.htm)|
|9|ユニバーサルプレート(2枚セット)|-|1|[購入先リンク](http://www.tamiya.com/japan/products/70157plate/index.htm)|
|10|樹脂スペーサー(M3/40mm)|BS-340E|8|[購入先リンク](http://www.hirosugi-net.co.jp/shop/g/g3802/)|
|11|樹脂スペーサー(M3/27mm)|BS-327E|8|[購入先リンク](http://www.hirosugi-net.co.jp/shop/g/g3789/)|
|12|樹脂スペーサー(M3/10mm)|BS-310E|8|[購入先リンク](http://www.hirosugi-net.co.jp/shop/g/g3769/)|
|13|ボールキャスター（2セット入）|-|1|[購入先リンク](http://www.tamiya.com/japan/products/70144ball_caster/)|
|14|平行ビニル電線|-|-|電線なら何でもよいが、参考までに、私は最大7A流せる電線を選択しました。|


### 1.3.2. 作成手順
車体本体は以下の順序で作成していきます。

1. [モーターユニット](#1321-モーターユニット作成)
2. [車体ベース部](#1322-車体ベース部作成)

#### 1.3.2.1. モーターユニット作成
モーターユニット作成には以下のパーツを使用します。
- ステッピングモーター × 2
- L6470 ステッピングモータ・ドライバキット × 2
- L6470/42x34mmステッピングモーター用ネジセット × 2
- 10Pフラットケーブル(30cm) × 2

「L6470 ステッピングモータ・ドライバキット」はソケットピン等を事前に半田付けしておきます。  
次に、ステッピングモーターの後ろ側に付いている４つのネジを外し、「L6470/42x34mmステッピングモーター用ネジセット」と「L6470 ステッピングモータ・ドライバキット」を使って、ステッピングモーターと一体化させます。  
ステッピングモーターの４本の線ですが、参考資料の「[Electrical_Circuit_Diagram.pdf][Electrical_Circuit_Diagram]」に従って
「L6470 ステッピングモータ・ドライバキット」に接続します。  
最後に、平行ビニル電線を「L6470 ステッピングモータ・ドライバキット」の電源部に、「10Pフラットケーブル(30cm)」をピンソケットにそれぞれ接続しておきます。
以下の図1.3.1が完成図です。  
「L6470 ステッピングモータ・ドライバキット」のジャンパ設定は内部レギュレータ使用と外部出力しないよう、図1.3.2のような設定にしてます。

|図1.3.1|図1.3.2|
|:--:|:--:|
|![fig.1.3.1](https://farm6.staticflickr.com/5062/29606258134_682f765995_b.jpg)|![fig.1.3.2](https://farm6.staticflickr.com/5484/29650757093_bca2cc89fe_b.jpg)|

このユニットを２つ作成します。

#### 1.3.2.2. 車体ベース部作成
車体ベース部作成には以下のパーツを使用します。
- ユニバーサルプレートL(210×160mm) × 2
- ユニバーサルプレート(2枚セット) × 1
- ボールキャスター（2セット入） × 1
- 樹脂スペーサー(M3/40mm) × 8
- 樹脂スペーサー(M3/27mm) × 8
- L字固定具（ステッピングモーター用） × 2
- アルミホイールΦ44（1個入） × 2
- タイヤΦ44用7.5mm幅（2個入） × 1


まずはユニバーサルプレートLを加工します。２枚とも配線を通す用途で中央付近に穴をあけます。位置と大きさは２枚とも同じです。下図1.3.3を参考にしてください。  
次は穴を開けたユニバーサルプレートLの１枚にL字固定具を２つ取り付けていきます。取り付け位置はユニバーサルプレートの中央です。取り付け幅は任意です。  
次に、前章で作成したモーターユニットを取り付けていきます。取り付ける向きですが、配線が飛び出ている側を横側にしたほうが無難です。下側にしてしまうと、走行時に配線が地面と接触してしまいます。  
取り付けが終わったら、モーター軸に「アルミホイールΦ44」と「タイヤΦ44用7.5mm幅」を取り付けていきます。  
ここまで来たら図1.3.4～図1.3.10のようなものが出来上がっていると思います。  

次はユニバーサルプレート(2枚セット)を加工します。まずは、側面の出っ張りを２枚とも全て切り落とします。次に、ボールキャスターを組み立て、プレートの中心に取り付けます。最後に、プレートの４隅に樹脂スペーサー(M3/27mm)をそれぞれ設置していきます。  
すると下図1.3.11、図1.3.12のようなものが２つ出来上がっていると思います。  

次に、ボールキャスター付きのユニバーサルプレート２枚を本体へ取り付けていきます。取り付けの際は樹脂スペーサー(M3/40mm)を8本使用します。（図1.3.13～図1.3.15）　　

最後に、残り１枚のユニバーサルプレートを樹脂スペーサー(M3/10mm)を使用して取り付けるのですが、先に[回路ユニット](#11-回路ユニット)を取る付けてからの方がよいでしょう。最後に、モーター電源用の平行ビニル電線とフラットケーブルをユニバーサルプレートの穴から通して完成です。（図1.3.16～図1.3.18）

|図1.3.3|図1.3.4|図1.3.5|
|:--:|:--:|:--:|
|![fig.1.3.3](https://farm6.staticflickr.com/5499/30206844426_62705709c0_c.jpg)|![1.3.4](https://farm6.staticflickr.com/5546/29611979713_635b323daa_c.jpg)|![fig.1.3.5](https://farm9.staticflickr.com/8409/30206836756_8d70755a68_c.jpg)|
|穴をあけた状態|モーター組み付け後（下側）|モーター組み付け後（上側）|

|図1.3.6|図1.3.7|図1.3.8|
|:--:|:--:|:--:|
|![fig.1.3.6](https://farm6.staticflickr.com/5520/29611075594_bb179d72af_b.jpg)|![fig.1.3.7](https://farm8.staticflickr.com/7535/30206838816_90046076c5_b.jpg)|![fig.1.3.8](https://farm6.staticflickr.com/5454/30126659482_9f28047461_b.jpg)|
|拡大図（前）|拡大図（下）|拡大図（後）|

|図1.3.9|図1.3.10|
|:--:|:--:|
|![fig.1.3.9](https://farm6.staticflickr.com/5577/29611073604_7f7dcaf0d4_b.jpg)|![fig.1.3.10](https://farm9.staticflickr.com/8555/30126662632_3f5e810f97_b.jpg)|
|拡大図（上側）|拡大図（横側）|

|図1.3.11|図1.3.12|
|:--:|:--:|
|![fig.1.3.11](https://farm6.staticflickr.com/5686/29611082104_65a29d9115_c.jpg)|![fig.1.3.12](https://farm9.staticflickr.com/8547/30206843496_de514713c0_c.jpg)|
|キャスター取り付け後（下側）|キャスター取り付け後（上側）|

|図1.3.13|図1.3.14|図1.3.15|
|:--:|:--:|:--:|
|![fig.1.3.13](https://farm6.staticflickr.com/5334/30263225365_fb0b9c6394_b.jpg)|![fig.1.3.14](https://farm6.staticflickr.com/5814/29966580790_8b9bcfd8d1_b.jpg)|![fig.1.3.15](https://farm6.staticflickr.com/5824/30263223785_fd3895f0ed_b.jpg)|
|下側|横側|上側|

|図1.3.16|図1.3.17|図1.3.18|
|:--:|:--:|:--:|
|![fig.1.3.16](https://farm6.staticflickr.com/5546/29966579770_6c91fef15a_b.jpg)|![fig.1.3.17](https://farm9.staticflickr.com/8551/29966578980_62ed563d86_b.jpg)|![fig.1.3.18](https://farm6.staticflickr.com/5780/30263222585_f594f93ec4_b.jpg)|
|回路ユニット取り付け後|車体本体に取り付け①|車体本体に取り付け②|


# 2. 各ユニット組み合わせ
[回路ユニット](#11-回路ユニット)、[MCUユニット](#12-mcuユニット)、[車体本体](#13-車体本体)の３つのユニットを全て結合させて完成です。  
以下、完成図です。

＜上側＞
![fig.2.1](https://farm9.staticflickr.com/8128/30245247596_8ee41991a1_b.jpg)

＜横側＞
![fig.2.2](https://farm6.staticflickr.com/5731/29648790564_5edc02c0a1_b.jpg)

＜下側＞
![fig.2.3](https://farm9.staticflickr.com/8277/30279548455_8fd67949e1_b.jpg)
***
# **＜最後に＞**  
ここまで見てくださってありがとうございます。(^^)  
何か不明点や質問等ありましたら以下のほうに気軽に連絡してください！
- **Twetter**  
https://twitter.com/Crafty_as_a_Fox
- **Blog**  
https://crafty-as-a-fox.tumblr.com
